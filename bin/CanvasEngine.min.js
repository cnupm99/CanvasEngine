// version 1.11, build 6, Mon Mar 05 2018
(function(){var g=function(f,k){function g(){this.constructor=f}for(var l in k)n.call(k,l)&&(f[l]=k[l]);g.prototype=k.prototype;f.prototype=new g;f.__super__=k.prototype;return f},n={}.hasOwnProperty,p=function(f,g){return function(){return f.apply(g,arguments)}};define(function(){var f=function(d){function b(a){b.__super__.constructor.call(this,a);this.name=a.name||"";this.type="DisplayObject";if(null!=a.canvas)this.canvas=a.canvas;else{var c=a.parent||document.body;this.canvas=document.createElement("canvas");
this.canvas.style.position="absolute";c.appendChild(this.canvas)}this.context=a.context||this.canvas.getContext("2d");this._setProperties(a)}g(b,d);b.prototype.set=function(a){if(null!=a)return null!=a.visible&&(this.visible=a.visible),this.visible?this.show():this.hide(),null!=a.position&&this.move(a.position),null!=a.size&&this.resize(a.size),null!=a.realSize&&this.upsize(a.realSize),null!=a.center&&this.setCenter(a.center),null!=a.anchor&&this.setAnchor(a.anchor),null!=a.scale&&this.zoom(a.scale),
null!=a.rotation&&this.rotate(a.rotation),null!=a.alpha&&this.setAlpha(a.alpha),null!=a.shadow&&this.setShadow(a.shadow),this.needAnimation=!0};b.prototype.show=function(){return this.needAnimation=this.visible=!0};b.prototype.hide=function(){this.visible=!1;this.needAnimation=!0;return!1};b.prototype.move=function(a,b){this.position=this.pixel(a,b);this.needAnimation=!0;return this.position};b.prototype.shift=function(a,b){null==b&&(b=0);return this.move([a+this.position[0],b+this.position[1]])};
b.prototype.resize=function(a,b){this.size=this.pixel(a,b);this.setAnchor(this.anchor);this.needAnimation=!0;return this.size};b.prototype.upsize=function(a,b){this.realSize=this.pixel(a,b);this.setAnchor(this.anchor);return this.realSize};b.prototype.setCenter=function(a,b){this.center=this.pixel(a,b);var c=0===this.size[0]&&0===this.size[1]?this.realSize:this.size;this.anchor=[0===c[0]?0:this.center[0]/c[0],0===c[1]?0:this.center[1]/c[1]];this.needAnimation=!0;return this.center};b.prototype.setAnchor=
function(a,b){this.anchor=this.point(a,b);var c=0===this.size[0]&&0===this.size[1]?this.realSize:this.size;this.center=[this["int"](c[0]*this.anchor[0]),this["int"](c[1]*this.anchor[1])];this.needAnimation=!0;return this.anchor};b.prototype.zoom=function(a,b){this.scale=null!=a?this.point(a,b):[1,1];this.needAnimation=!0;return this.scale};b.prototype.rotate=function(a){this.rotation=this["int"](a);0>this.rotation&&(this.rotation=360+this.rotation);360<=this.rotation&&(this.rotation%=360);this._rotation=
this.rotation*this._PIDIV180;this.needAnimation=!0;return this.rotation};b.prototype.rotateOn=function(a){return this.rotate(this.rotation+this["int"](a))};b.prototype.setAlpha=function(a){this.alpha=a?this.number(a):1;0>this.alpha&&(this.alpha=0);1<this.alpha&&(this.alpha=1);this.needAnimation=!0;return this.alpha};b.prototype.setShadow=function(a){this.shadow=null!=a&&a?{color:a.color||"#000",blur:a.blur||3,offsetX:this["int"](a.offsetX),offsetY:this["int"](a.offsetY),offset:this["int"](a.offset)}:
!1;this.needAnimation=!0;return this.shadow};b.prototype.testPoint=function(a,b){var c=this.canvas.getBoundingClientRect();c=this.context.getImageData(a-c.left,b-c.top,1,1).data;null==c.every&&(c.every=Array.prototype.every);return!c.every(function(a){return 0===a})};b.prototype.testRect=function(a,b){var c=this.canvas.getBoundingClientRect();"scene"!==this.type&&(c={left:c.left+this.position[0],top:c.top+this.position[1],right:c.left+this.position[0]+this.size[0],bottom:c.top+this.position[1]+this.size[1]});
return a>=c.left&&a<=c.right&&b>=c.top&&b<=c.bottom};b.prototype.animate=function(){this._deltaX=this.position[0];this._deltaY=this.position[1];this.shadow&&(this.context.shadowColor=this.shadow.color,this.context.shadowBlur=this.shadow.blur,this.context.shadowOffsetX=Math.max(this.shadow.offsetX,this.shadow.offset),this.context.shadowOffsetY=Math.max(this.shadow.offsetY,this.shadow.offset));1===this.scale[0]&&1===this.scale[1]||this.context.scale(this.scale[0],this.scale[1]);1!==this.alpha&&(this.context.globalAlpha=
this.alpha);0!==this.rotation&&(this.context.translate(this.center[0]+this.position[0],this.center[1]+this.position[1]),this.context.rotate(this._rotation),this._deltaX=-this.center[0],this._deltaY=-this.center[1]);return this.needAnimation=!1};b.prototype._setProperties=function(a){(this.visible=null!=a.visible?a.visible:!0)?this.show():this.hide();this.move(a.position);this.realSize=[0,0];this.resize(a.size);null==a.center&&null!=a.anchor||this.setCenter(a.center);null!=a.anchor&&null==a.center&&
this.setAnchor(a.anchor);this.zoom(a.scale);this.rotate(a.rotation);this.setAlpha(a.alpha);this.setShadow(a.shadow);return this.needAnimation=!0};b.prototype.getOptions=function(){return{name:this.name,type:this.type,visible:this.visible,position:[this.position[0],this.position[1]],size:[this.size[0],this.size[1]],realSize:[this.realSize[0],this.realSize[1]],center:[this.center[0],this.center[1]],anchor:[this.anchor[0],this.anchor[1]],scale:[this.scale[0],this.scale[1]],rotation:this.rotation,alpha:this.alpha,
shadow:this.shadow?{blur:this.shadow.blur,color:this.shadow.color,offset:this.shadow.offset,offsetX:this.shadow.offsetX,offsetY:this.shadow.offsetY}:!1}};return b}(function(){function d(b){}d.prototype.point=function(b,a){return null==b?[0,0]:null!=a?[this.number(b),this.number(a)]:Array.isArray(b)?[this.number(b[0]),this.number(b[1])]:null!=b.x&&null!=b.y?[this.number(b.x),this.number(b.y)]:null!=b.width&&null!=b.height?[this.number(b.width),this.number(b.height)]:[0,0]};d.prototype.pixel=function(b,
a){var c=this.point(b,a);return[c[0]>>0,c[1]>>0]};d.prototype["int"]=function(b){return this.number(b)>>0};d.prototype.number=function(b){return null!=b?+b:0};d.prototype.deg2rad=function(b){return this.number(b)*this._PIDIV180};d.prototype._PIDIV180=Math.PI/180;return d}());var k=function(d){function b(a){b.__super__.constructor.call(this,a);this.childrens=[]}g(b,d);b.prototype.get=function(a){a=this.index(a);return-1===a?!1:this.childrens[a]};b.prototype.remove=function(a){a=this.index(a);if(-1===
a)return!1;this.childrens.splice(a,1);return this.needAnimation=!0};b.prototype.rename=function(a,b){var c=this.index(a);if(-1===c)return!1;this.childrens[c].name=b;return!0};b.prototype.index=function(a){var b=-1;this.childrens.some(function(c,h){var e;(e=c.name===a)&&(b=h);return e});return b};return b}(f);var n=function(d){function b(a){b.__super__.constructor.call(this,a);this.type="graph";this._commands=a.commands||[]}g(b,d);b.prototype.clear=function(){this._commands=[];return this.needAnimation=
!0};b.prototype.beginPath=function(){return this._commands.push({command:"beginPath"})};b.prototype.lineCap=function(a){return this._commands.push({command:"lineCap",lineCap:a})};b.prototype.strokeStyle=function(a){return this._commands.push({command:"strokeStyle",style:a})};b.prototype.fillStyle=function(a){return this._commands.push({command:"fillStyle",style:a})};b.prototype.linearGradient=function(a,b,e,h,d){return this._commands.push({command:"gradient",point1:this.pixel(a,b),point2:this.pixel(e,
h),colors:d})};b.prototype.lineWidth=function(a){return this._commands.push({command:"lineWidth",width:this["int"](a)})};b.prototype.setLineDash=function(a){return this._commands.push({command:"setDash",dash:a})};b.prototype.lineDashOffset=function(a){return this._commands.push({command:"dashOffset",offset:this["int"](a)})};b.prototype.moveTo=function(a,b){return this._commands.push({command:"moveTo",point:this.pixel(a,b)})};b.prototype.lineTo=function(a,b){this._commands.push({command:"lineTo",point:this.pixel(a,
b)});return this.needAnimation=!0};b.prototype.line=function(a,b,e,h){this._commands.push({command:"line",from:this.pixel(a,b),to:this.pixel(e,h)});return this.needAnimation=!0};b.prototype.rect=function(a,b,e,h,d){null==d&&(d=0);this._commands.push({command:"rect",point:this.pixel(a,b),size:this.pixel(e,h),radius:this["int"](d)});return this.needAnimation=!0};b.prototype.circle=function(a,b,e){this._commands.push({command:"circle",center:this.pixel(a,b),radius:this["int"](e)});return this.needAnimation=
!0};b.prototype.arc=function(a,b,e,h,d,m){this._commands.push({command:"arc",center:this.pixel(a,b),radius:this["int"](e),beginAngle:this.deg2rad(h),endAngle:this.deg2rad(d),antiClockWise:m||!1});return this.needAnimation=!0};b.prototype.polyline=function(a,b){null==b&&(b=!0);this._commands.push({command:"beginPath"});this.moveTo(a[0][0],a[0][1]);a.forEach(function(a){return function(b){return a.lineTo(b[0],b[1])}}(this));b&&this.stroke();return this.needAnimation=!0};b.prototype.polygon=function(a){this.polyline(a,
!1);this.lineTo(a[0][0],a[0][1]);this.stroke();return this.fill()};b.prototype.fill=function(){this._commands.push({command:"fill"});return this.needAnimation=!0};b.prototype.stroke=function(){this._commands.push({command:"stroke"});return this.needAnimation=!0};b.prototype.animate=function(){if(this.visible)return b.__super__.animate.call(this),this.context.lineCap="round",this._commands.forEach(function(a){return function(b){switch(b.command){case "beginPath":return a.context.beginPath();case "lineCap":return a.context.lineCap=
b.lineCap;case "stroke":return a.context.stroke();case "fill":return a.context.fill();case "setDash":return a.context.setLineDash(b.dash);case "dashOffset":return a.context.lineDashOffset=b.offset;case "moveTo":return a.context.moveTo(b.point[0]+a._deltaX,b.point[1]+a._deltaY);case "lineTo":return a.context.lineTo(b.point[0]+a._deltaX,b.point[1]+a._deltaY);case "line":return a.context.beginPath(),a.context.moveTo(b.from[0]+a._deltaX,b.from[1]+a._deltaY),a.context.lineTo(b.to[0]+a._deltaX,b.to[1]+
a._deltaY),a.context.stroke();case "strokeStyle":return a.context.strokeStyle=b.style;case "fillStyle":return a.context.fillStyle=b.style;case "lineWidth":return a.context.lineWidth=b.width;case "rect":return a.context.beginPath(),0===b.radius?a.context.rect(b.point[0]+a._deltaX,b.point[1]+a._deltaY,b.size[0],b.size[1]):a._drawRoundedRect(a.context,b.point[0]+a._deltaX,b.point[1]+a._deltaY,b.size[0],b.size[1],b.radius);case "circle":return a.context.beginPath(),a.context.arc(b.center[0]+a._deltaX,
b.center[1]+a._deltaY,b.radius,0,2*Math.PI,!1);case "arc":return a.context.beginPath(),a.context.arc(b.center[0]+a._deltaX,b.center[1]+a._deltaY,b.radius,b.beginAngle,b.endAngle,b.antiClockWise);case "gradient":var c=a.context.createLinearGradient(b.point1[0]+a._deltaX,b.point1[1]+a._deltaY,b.point2[0]+a._deltaX,b.point2[1]+a._deltaY);b.colors.forEach(function(a){return c.addColorStop(a[0],a[1])});return a.context.fillStyle=c}}}(this));this.needAnimation=!1};b.prototype.log=function(){return console.log(this._commands)};
b.prototype.getOptions=function(){var a=b.__super__.getOptions.call(this);a.commands=this._commands;return a};b.prototype._drawRoundedRect=function(a,b,e,d,g,m){var c=Math.PI;var h=c/2;var f=b+m;var k=b+d-m;var l=e+m;var n=e+g-m;a.moveTo(f,e);a.lineTo(k,e);a.arc(k,l,m,-h,0);a.lineTo(b+d,n);a.arc(k,n,m,0,h);a.lineTo(f,e+g);a.arc(f,n,m,h,c);a.lineTo(b,l);return a.arc(f,l,m,c,3*h)};return b}(f);var l=function(d){function b(a){this._imageOnLoad=p(this._imageOnLoad,this);b.__super__.constructor.call(this,
a);this.type="image";this.onload=a.onload;this.loaded=!1;this.image=document.createElement("img");this.image.onload=this._imageOnLoad;this.loadedFrom="";this.setRect(a.rect);null!=a.src?this.src(a.src):this.from(a.from)}g(b,d);b.prototype.setRect=function(a){this.rect=a||!1;this.needAnimation=!0;return this.rect};b.prototype.src=function(a){this.loaded=!1;this.loadedFrom=a;return this.image.src=a};b.prototype.from=function(a,b){if(null!=a)return this.image=a,this.loadedFrom=b||"",this.upsize([this.image.width,
this.image.height]),(0>=this.size[0]||0>=this.size[1])&&this.resize(this.realSize),this.needAnimation=this.loaded=!0};b.prototype.animate=function(){if(this.loaded){if(this.visible)return b.__super__.animate.call(this),this.rect?this.context.drawImage(this.image,this.rect[0],this.rect[1],this.rect[2],this.rect[3],this._deltaX,this._deltaY,this.size[0],this.size[1]):this.size[0]===this.realSize[0]&&this.size[1]===this.realSize[1]?this.context.drawImage(this.image,this._deltaX,this._deltaY):this.context.drawImage(this.image,
this._deltaX,this._deltaY,this.size[0],this.size[1]);this.needAnimation=!1}};b.prototype._imageOnLoad=function(a){this.upsize([this.image.width,this.image.height]);(0>=this.size[0]||0>=this.size[1])&&this.resize(this.realSize);this.needAnimation=this.loaded=!0;if(null!=this.onload)return this.onload(this.realSize)};b.prototype.getOptions=function(){var a=b.__super__.getOptions.call(this);a.rect=this.rect?[this.rect[0],this.rect[1],this.rect[2],this.rect[3]]:!1;this.loaded?(a.from=this.image,a.loadedFrom=
this.loadedFrom):0<this.loadedFrom.length&&(a.src=this.loadedFrom);a.loaded=this.loaded;return a};return b}(f);var q=function(d){function b(a){b.__super__.constructor.call(this,a);this.type="text";this.textWidth=this.fontHeight=0;this.setFont(a.font);this.setFillStyle(a.fillStyle);this.setStrokeStyle(a.strokeStyle);this.setStrokeWidth(a.strokeWidth);this.setUnderline(a.underline,a.underlineOffset);this.write(a.text)}g(b,d);b.prototype.setFont=function(a){this.font=a||"12px Arial";this.fontHeight=
this._getFontHeight(this.font);this.needAnimation=!0;return this.font};b.prototype.setFillStyle=function(a){this.fillStyle=a||!1;this.needAnimation=!0;return this.fillStyle};b.prototype.setStrokeStyle=function(a){this.strokeStyle=a||!1;this.needAnimation=!0;return this.strokeStyle};b.prototype.setStrokeWidth=function(a){this.strokeWidth=null!=a?this["int"](a):1;this.needAnimation=!0;return this.strokeWidth};b.prototype.setUnderline=function(a,b){this.underline=a||!1;this.underlineOffset=b||0;this.needAnimation=
!0;return this.underline};b.prototype.write=function(a){this.text=a||"";this.upsize(this._getRealSizes(this.text));this.textWidth=this.realSize[0];this.textHeight=this.realSize[1];this.needAnimation=!0;return this.text};b.prototype.animate=function(){if(this.visible){b.__super__.animate.call(this);this.context.font=this.font;this.context.textBaseline="top";if(this.fillStyle)if(Array.isArray(this.fillStyle)){var a=this.context.createLinearGradient(this._deltaX,this._deltaY,this._deltaX,this._deltaY+
this.fontHeight);this.fillStyle.forEach(function(b){return a.addColorStop(b[0],b[1])});this.context.fillStyle=a}else this.context.fillStyle=this.fillStyle;this.strokeStyle&&(this.context.strokeStyle=this.strokeStyle,this.context.lineWidth=this.strokeWidth);var c=this.text.split("\n");var e=this._deltaY;if(this.underline){var d=parseInt(this.font,10);var f=this.strokeStyle||this.fillStyle}return c.forEach(function(a){return function(b){a.fillStyle&&a.context.fillText(b,a._deltaX,e);a.strokeStyle&&
a.context.strokeText(b,a._deltaX,e);a.underline&&(b=a._getTextWidth(b),a.context.strokeStyle=f,a.context.lineWidth=a.strokeWidth||1,a.context.beginPath(),a.context.moveTo(a._deltaX,e+d+a.underlineOffset),a.context.lineTo(a._deltaX+b,e+d+a.underlineOffset),a.context.stroke());return e+=a.fontHeight}}(this))}this.needAnimation=!1};b.prototype._getFontHeight=function(a){var b=document.createElement("span");b.appendChild(document.createTextNode("height"));b.style.cssText="font: "+a+"; white-space: nowrap; display: inline;";
document.body.appendChild(b);a=b.offsetHeight;document.body.removeChild(b);return a};b.prototype._getTextWidth=function(a){this.context.save();this.context.font=this.font;a=this.context.measureText(a).width;this.context.restore();return a};b.prototype._getRealSizes=function(a){var b=0;a=this.text.split("\n");a.forEach(function(a){return function(c){c=a._getTextWidth(c);if(c>b)return b=c}}(this));return[b,a.length*this.fontHeight]};b.prototype.getOptions=function(){var a=b.__super__.getOptions.call(this);
a.fontHeight=this.fontHeight;a.textWidth=this.textWidth;a.textHeight=this.textHeight;a.font=this.font;a.fillStyle=this.fillStyle;a.strokeStyle=this.strokeStyle;a.strokeWidth=this.strokeWidth;a.underline=this.underline;a.underlineOffset=this.underlineOffset;a.text=this.text;return a};return b}(f);var r=function(d){function b(a){b.__super__.constructor.call(this,a);this.type="tile";this.setRect(a.rect)}g(b,d);b.prototype.setRect=function(a){this.rect=a||[0,0,this.canvas.width,this.canvas.height];this.needAnimation=
!0;return this.rect};b.prototype.animate=function(){if(this.loaded){if(this.visible)return this.context.beginPath(),this.context.fillStyle=this.context.createPattern(this.image,"repeat"),this.context.rect(this.rect[0],this.rect[1],this.rect[2],this.rect[3]),this.context.fill(),this.needAnimation=!1;this.needAnimation=!1}};return b}(l);var t=function(d){function b(a){b.__super__.constructor.call(this,a);this.type="scene";this.setZIndex(a.zIndex);this.setMask(a.mask);this.needAnimation=!1}g(b,d);b.prototype.add=
function(a){if(null!=a.type){null==a.visible&&(a.visible=this.visible);null==a.shadow&&(a.shadow=this.shadow);a.canvas=this.canvas;a.context=this.context;switch(a.type){case "image":var b=new l(a);break;case "text":b=new q(a);break;case "graph":b=new n(a);break;case "tile":b=new r(a)}this.childrens.push(b);return b}};b.prototype.clone=function(a){return this.add(a.getOptions())};b.prototype.clear=function(){this.childrens=[];return this.needAnimation=!0};b.prototype.setMask=function(a){this.mask=
null!=a&&a?a:!1;this.needAnimation=!0;return this.mask};b.prototype.setZIndex=function(a){this.zIndex=this["int"](a);return this.canvas.style.zIndex=this.zIndex};b.prototype.hide=function(){b.__super__.hide.call(this);return this.context.clearRect(0,0,this.size[0],this.size[1])};b.prototype.move=function(a,c){b.__super__.move.call(this,a,c);this.canvas.style.left=this.position[0]+"px";this.canvas.style.top=this.position[1]+"px";return this.position};b.prototype.shiftAll=function(a,b){null==b&&(b=
0);return this.childrens.forEach(function(c){return c.shift(a,b)})};b.prototype.resize=function(a,c){b.__super__.resize.call(this,a,c);this.canvas.width=this.size[0];this.canvas.height=this.size[1];return this.size};b.prototype.setCenter=function(a,c){b.__super__.setCenter.call(this,a,c);this.context.translate(this.center[0],this.center[1]);return this.center};b.prototype.setAnchor=function(a,c){b.__super__.setAnchor.call(this,a,c);this.context.translate(this.center[0],this.center[1]);return this.anchor};
b.prototype.rotate=function(a){b.__super__.rotate.call(this,a);this.context.rotate(this._rotation);return this.rotation};b.prototype.setAlpha=function(a){b.__super__.setAlpha.call(this,a);return this.context.globalAlpha=this.alpha};b.prototype.animate=function(){if(this.visible)return this.context.clearRect(0,0,this.size[0],this.size[1]),this.mask&&(this.context.beginPath(),this.context.rect(this.mask[0],this.mask[1],this.mask[2],this.mask[3]),this.context.clip()),this.childrens.forEach(function(a){return function(b){a.context.save();
b.animate();return a.context.restore()}}(this)),this.needAnimation=!1;this.needAnimation=!1};return b}(k);return function(d){function b(a){this._animate=p(this._animate,this);b.__super__.constructor.call(this,a);if(!this.canvasSupport())return console.log("your browser not support canvas and/or context"),!1;this.parent=a.parent||document.body;0===this.size[0]&&0===this.size[1]&&(this.size=[this["int"](this.parent.clientWidth),this["int"](this.parent.clientHeight)]);this._beforeAnimate=[];this._scene=
"default";this.add({type:"scene",name:"default"});this.start()}g(b,d);b.prototype.add=function(a){var b;null==a&&(a={});if("scene"===(a.type||"scene"))return this._createScene(a);(b=this.get(a.scene))||(b=this.getActive());b||(b=this.add({type:"scene",name:"default"}));return b.add(a)};b.prototype.remove=function(a){a=this.index(a);if(-1===a)return!1;this.parent.removeChild(this.childrens[a].canvas);this.childrens.splice(a,1);return!0};b.prototype.onTop=function(a){var b=0;var d=!1;this.childrens.forEach(function(c){c.zIndex>
b&&(b=c.zIndex);if(a===c.name)return d=c});d&&d.setZIndex(b+1);return d};b.prototype.getActive=function(){var a;(a=this.get(this._scene))||(a=this.childrens[0]);a||(a=!1);return a};b.prototype.setActive=function(a){this._scene=a||"default";return this.getActive()};b.prototype.start=function(){return this._render=requestAnimationFrame(this._animate)};b.prototype.stop=function(){return cancelAnimationFrame(this._render)};b.prototype.addEvent=function(a){return this._beforeAnimate.push(a)};b.prototype.removeEvent=
function(a){return this._beforeAnimate.forEach(function(b){return function(c,d){if(c===a)return b._beforeAnimate.splice(d,1)}}(this))};b.prototype.canvasSupport=function(){return null!=document.createElement("canvas").getContext};b.prototype._createScene=function(a){null==a.visible&&(a.visible=this.visible);null==a.position&&(a.position=this.position);null==a.size&&(a.size=this.size);null==a.center&&(a.center=this.center);null==a.rotation&&(a.rotation=this.rotation);null==a.alpha&&(a.alpha=this.alpha);
null==a.mask&&(a.mask=this.mask);null==a.shadow&&(a.shadow=this.shadow);a.parent=this.parent;a=new t(a);this.childrens.push(a);this.setActive(a.name);return a};b.prototype._animate=function(){this._beforeAnimate.forEach(function(a){return function(b,d){return"function"===typeof b?b():a._beforeAnimate.splice(d,1)}}(this));this.needAnimation=!1;this.childrens.forEach(function(a){return function(b){var c=b.needAnimation||b.childrens.some(function(a){return a.needAnimation});a.needAnimation=a.needAnimation||
c;if(c)return b.animate()}}(this));return this._render=requestAnimationFrame(this._animate)};return b}(k)})}).call(this);